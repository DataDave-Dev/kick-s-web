---
const {
    Producto_id,
    Producto,
    Descripcion,
    Precio,
    Cantidad,
    Imagen,
    Categoria,
    Marca,
    Estilo,
} = Astro.props;
---

<div
    class="rounded-2xl shadow-xl overflow-hidden bg-white flex flex-col hover:shadow-2xl transition-shadow duration-300 max-w-xs mx-auto sm:max-w-full"
>
    <div class="relative">
        <img
            src={Imagen}
            alt={Producto}
            class="w-full h-48 object-cover transition-transform duration-300 hover:scale-105"
        />
        {
            Cantidad === 0 && (
                <span class="absolute top-2 right-2 bg-gray-800 text-white text-xs px-3 py-1 rounded-full opacity-90 font-bold">
                    Sin stock
                </span>
            )
        }
    </div>
    <div class="p-4 flex flex-col flex-1">
        <h2 class="text-lg md:text-xl font-extrabold mb-1 text-gray-900">
            {Producto}
        </h2>
        <p class="text-gray-600 text-sm mb-2 line-clamp-2">{Descripcion}</p>
        <div class="flex flex-wrap gap-2 text-xs mb-2">
            <span class="bg-gray-100 text-gray-700 px-2 py-1 rounded"
                >Marca: <span class="font-semibold">{Marca}</span></span
            >
            <span class="bg-gray-100 text-gray-700 px-2 py-1 rounded"
                >Categoría: <span class="font-semibold">{Categoria}</span></span
            >
            <span class="bg-gray-100 text-gray-700 px-2 py-1 rounded"
                >Estilo: <span class="font-semibold">{Estilo}</span></span
            >
        </div>
        <div
            class="flex flex-col sm:flex-row items-start sm:items-center justify-between mt-2 mb-4 gap-2"
        >
            <span class="text-gray-500 text-xs"
                >Disponibles: <span class="font-semibold">{Cantidad}</span
                ></span
            >
            <span class="text-lg font-bold text-red-500">${Precio}</span>
        </div>
        <button
            type="button"
            class="mt-auto bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-full shadow transition-all w-full disabled:opacity-60 disabled:cursor-not-allowed"
            disabled={Cantidad === 0}
            onclick={`(function(){
                let cart = JSON.parse(localStorage.getItem('cart') || '[]');
                cart.push({
                    Producto_id: ${JSON.stringify(Producto_id)},
                    Producto: ${JSON.stringify(Producto)},
                    Descripcion: ${JSON.stringify(Descripcion)},
                    Precio: ${JSON.stringify(Precio)},
                    Imagen: ${JSON.stringify(Imagen)},
                    Marca: ${JSON.stringify(Marca)},
                    Categoria: ${JSON.stringify(Categoria)},
                    Estilo: ${JSON.stringify(Estilo)},
                    Cantidad: 1
                });
                localStorage.setItem('cart', JSON.stringify(cart));
                if(window.updateCartCount) window.updateCartCount();
                this.textContent = '¡Agregado!';
                setTimeout(()=>{this.textContent='Agregar al carrito'}, 1000);
            }).call(this)`}
        >
            Agregar al carrito
        </button>
    </div>
</div>

<style>
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    @media (max-width: 640px) {
        .max-w-xs {
            max-width: 100%;
        }
        .p-4 {
            padding: 1rem !important;
        }
        .h-48 {
            height: 10rem !important;
        }
        .text-lg {
            font-size: 1.125rem !important;
        }
        .text-xl {
            font-size: 1.25rem !important;
        }
    }
</style>
